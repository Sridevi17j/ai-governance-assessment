# ğŸ“§ Email Feature Setup Guide\n\n## âœ… What's Implemented\n\nâœ… **Email Button**: Added next to \"Download PDF\" button  \nâœ… **Gmail API Integration**: Uses your existing Google Cloud project  \nâœ… **PDF Attachment**: Automatically attaches assessment report  \nâœ… **Professional Email**: Formatted email with assessment summary  \nâœ… **Success/Error Messages**: Shows status after sending  \nâœ… **Loading States**: Button shows \"Sending...\" with spinner  \n\n## ğŸš€ Quick Setup Steps\n\n### 1. Install Dependencies\n```bash\ncd C:\\Users\\sride\\Desktop\\ai-governance-assessment\nnpm run setup\n```\n\n### 2. Convert Token File\nYour `token.pickle` needs to be converted to JSON format:\n\n**Option A: Python Script (Recommended)**\n```python\n# Create convert_token.py in the same folder as token.pickle\nimport pickle\nimport json\n\nwith open('token.pickle', 'rb') as f:\n    creds = pickle.load(f)\n\ntoken_data = {\n    'access_token': creds.token,\n    'refresh_token': creds.refresh_token,\n    'token_uri': creds.token_uri,\n    'client_id': creds.client_id,\n    'client_secret': creds.client_secret,\n    'scopes': creds.scopes\n}\n\nwith open('token.json', 'w') as f:\n    json.dump(token_data, f, indent=2)\n\nprint(\"âœ… Converted to token.json\")\n```\n\nRun: `python convert_token.py`\n\n### 3. Place Token File\nMove `token.json` to project root:\n```\nai-governance-assessment/\nâ”œâ”€â”€ token.json  â† Place here\nâ”œâ”€â”€ apps/\nâ”œâ”€â”€ data/\nâ””â”€â”€ ...\n```\n\n### 4. Test the Feature\n```bash\nnpm run dev\n```\n\n1. Complete an assessment\n2. Click \"ğŸ“§ Email to Manager\" button  \n3. Should show \"âœ… Email sent successfully!\"\n\n## ğŸ“§ How It Works\n\n### Email Flow:\n1. **User clicks \"Email to Manager\"**\n2. **Generates PDF** (same as download)\n3. **Sends to Gmail API** with PDF attachment\n4. **Shows success message**: \"âœ… Email sent successfully to [Manager Name]!\"\n\n### Email Content:\n```\nSubject: FINOS AI Governance Assessment Report - [Product Name]\n\nDear [Manager Name],\n\nYour FINOS AI Governance Assessment for \"[Product]\" has been completed.\n\nAssessment Summary:\nâ€¢ Overall Compliance Score: [Score]/100\nâ€¢ Assessment Date: [Date]\nâ€¢ Risks Evaluated: [Risk Types]\n\nPlease find the detailed report attached as a PDF.\n\nBest regards,\nAI Governance Assessment System\n```\n\n## ğŸ¨ UI Features\n\n### Button States:\n- **Default**: \"ğŸ“§ Email to Manager\"\n- **Loading**: \"ğŸ“§ Sending...\" (with spinner)\n- **Success**: \"âœ… Email sent successfully!\"\n- **Error**: \"âŒ Failed to send email\"\n\n### Smart Validation:\n- Button disabled if no manager email\n- Shows helpful error messages\n- Automatic status clearing after 5-8 seconds\n\n## ğŸ”§ Troubleshooting\n\n### Common Issues:\n\n**\"No token file found\"**\nâ†’ Convert token.pickle to token.json and place in root\n\n**\"Gmail authentication failed\"**\nâ†’ Check token.json format and OAuth credentials\n\n**\"Token expired\"** \nâ†’ Regenerate token.pickle from your Python script\n\n**\"Email not sending\"**\nâ†’ Check Gmail API is enabled in Google Cloud Console\n\n### Debug Steps:\n1. Check browser console for errors\n2. Verify token.json exists in project root\n3. Ensure Gmail API scope includes 'gmail.send'\n4. Test with your existing Python email script first\n\n## ğŸ” Security Notes\n\n- Never commit token.json to git\n- Add to .gitignore: `token.json`\n- Token auto-refreshes when expired\n- Uses your existing OAuth2 setup\n\n## ğŸ“ Files Modified\n\nâœ… `apps/web/package.json` - Added googleapis dependency  \nâœ… `apps/web/src/app/api/send-email/route.ts` - Email API endpoint  \nâœ… `apps/web/src/components/ResultsDisplay.tsx` - Email button & UI  \nâœ… `package.json` - Updated setup scripts  \nâœ… `TOKEN-SETUP.md` - Detailed token conversion guide  \n\n## ğŸ¯ Ready to Test!\n\n1. **Install**: `npm run setup`\n2. **Convert**: token.pickle â†’ token.json  \n3. **Place**: token.json in project root\n4. **Run**: `npm run dev`\n5. **Test**: Complete assessment â†’ Click \"Email to Manager\"\n\n**Expected Result**: âœ… Email sent successfully to [Manager Name]!\n\nThe product manager will receive a professional email with the PDF assessment report attached! ğŸš€\n